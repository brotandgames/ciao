sudo: false
language: ruby
cache: bundler
rvm:
  - 2.6.3
before_install:
  - gem install bundler -v 2.0.2
  - curl https://raw.githubusercontent.com/kubernetes/helm/master/scripts/get > get_helm.sh
  - chmod 700 get_helm.sh
  - sudo ./get_helm.sh
script:
  - yarn install --check-files
  - bundle exec rubocop
  - bundle exec rake
  - ./scripts/chart/ci.sh
deploy:
  provider: script
  script: ./scripts/docker/release-image.sh
  on:
    tags: true
    all_branches: true

